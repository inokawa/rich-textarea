{"version":3,"file":"Toolbar.stories.5a8bfd4e.js","sources":["../../stories/examples/Toolbar.stories.tsx"],"sourcesContent":["import { StoryObj } from \"@storybook/react\";\nimport { useRef, useState } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { RichTextarea } from \"../../src\";\nimport { RichTextareaHandle } from \"../../src\";\n\nexport default {\n  component: RichTextarea,\n};\n\nconst style = { width: \"400px\", height: \"300px\" };\n\nconst Menu = ({\n  top,\n  left,\n  onSelectBold,\n  onSelectItalic,\n  onSelectStrike,\n}: {\n  top: number;\n  left: number;\n  onSelectBold: () => void;\n  onSelectItalic: () => void;\n  onSelectStrike: () => void;\n}) => {\n  return (\n    <div\n      style={{\n        position: \"fixed\",\n        top: top,\n        left: left,\n      }}\n    >\n      <button onMouseDown={onSelectBold}>\n        <b>B</b>\n      </button>\n      <button onMouseDown={onSelectItalic}>\n        <i>I</i>\n      </button>\n      <button onMouseDown={onSelectStrike}>\n        <s>S</s>\n      </button>\n    </div>\n  );\n};\n\nexport const Toolbar: StoryObj = {\n  render: () => {\n    const ref = useRef<RichTextareaHandle>(null);\n    const [text, setText] = useState(`Select text and click any button.\\n\\n`);\n    const [[selectionStart, selectionEnd, pos], setSelection] = useState<\n      [number, number, { top: number; left: number } | undefined] | []\n    >([]);\n    const hideMenu =\n      selectionStart == null ||\n      selectionEnd == null ||\n      selectionStart === selectionEnd;\n\n    return (\n      <div style={{ position: \"relative\", paddingTop: 16 }}>\n        <RichTextarea\n          ref={ref}\n          value={text}\n          style={style}\n          onChange={(e) => setText(e.target.value)}\n          onSelectionChange={(p) => {\n            setSelection([\n              p.selectionStart,\n              p.selectionEnd,\n              p.focused\n                ? {\n                    top: p.top - p.height * 1.5 /* FIXME */,\n                    left: p.left,\n                  }\n                : undefined,\n            ]);\n          }}\n        />\n        {pos &&\n          !hideMenu &&\n          createPortal(\n            <Menu\n              top={pos.top}\n              left={pos.left}\n              onSelectBold={() => {\n                if (!ref.current) return;\n                const start = ref.current.selectionStart;\n                const end = ref.current.selectionEnd;\n                ref.current.setRangeText(\n                  `**${text.slice(start, end)}**`,\n                  start,\n                  end\n                );\n              }}\n              onSelectItalic={() => {\n                if (!ref.current) return;\n                const start = ref.current.selectionStart;\n                const end = ref.current.selectionEnd;\n                ref.current.setRangeText(\n                  `*${text.slice(start, end)}*`,\n                  start,\n                  end\n                );\n              }}\n              onSelectStrike={() => {\n                if (!ref.current) return;\n                const start = ref.current.selectionStart;\n                const end = ref.current.selectionEnd;\n                ref.current.setRangeText(\n                  `~~${text.slice(start, end)}~~`,\n                  start,\n                  end\n                );\n              }}\n            />,\n            document.body\n          )}\n      </div>\n    );\n  },\n};\n"],"names":["Toolbar_stories","component","RichTextarea","style","width","height","Menu","top","left","onSelectBold","onSelectItalic","onSelectStrike","position","_jsx","Toolbar","render","ref","useRef","text","setText","useState","selectionStart","selectionEnd","pos","setSelection","hideMenu","paddingTop","e","target","value","p","focused","undefined","createPortal","current","start","end","setRangeText","slice","document","body"],"mappings":"8SAMA,MAAeA,EAAA,CACbC,UAAWC,CACb,EAEMC,EAAQ,CAAEC,MAAO,QAASC,OAAQ,OAAQ,EAE1CC,EAAO,CAAC,CACZC,IAAAA,EACAC,KAAAA,EACAC,aAAAA,EACAC,eAAAA,EACAC,eAAAA,CAOF,MAEI,MAAA,CACE,MAAO,CACLC,SAAU,QACVL,IAAAA,EACAC,KAAAA,CACF,EAAE,SAEF,CAAAK,EAAA,SAAA,CAAQ,YAAaJ,EAAa,WAChC,IAAA,CAAA,SAAA,GAAA,CAAA,CAAA,CAAQ,EAEVI,EAAA,SAAA,CAAQ,YAAaH,EAAe,WAClC,IAAA,CAAA,SAAA,GAAA,CAAA,CAAA,CAAQ,EAEVG,EAAA,SAAA,CAAQ,YAAaF,EAAe,WAClC,IAAA,CAAA,SAAA,GAAA,CAAA,CAAA,CACO,CAAA,CAAA,CACL,EAIGG,EAAoB,CAC/BC,OAAQ,IAAM,CACNC,MAAAA,EAAMC,iBAA2B,IAAI,EACrC,CAACC,EAAMC,CAAO,EAAIC,EAAU,QAAA,SAAA;AAAA;AAAA,CAAsC,EAClE,CAAC,CAACC,EAAgBC,EAAcC,CAAG,EAAGC,CAAY,EAAIJ,mBAE1D,CAAA,CAAE,EACEK,EACJJ,GAAkB,MAClBC,GAAgB,MAChBD,IAAmBC,EAErB,SACE,MAAA,CAAK,MAAO,CAAEV,SAAU,WAAYc,WAAY,EAAG,EAAE,SAAA,CACnDb,EAACX,EAAY,CACX,IAAAc,EACA,MAAOE,EACP,MAAAf,EACA,SAAWwB,GAAMR,EAAQQ,EAAEC,OAAOC,KAAK,EACvC,kBAA0BC,GAAA,CACxBN,EAAa,CACXM,EAAET,eACFS,EAAER,aACFQ,EAAEC,QACE,CACExB,IAAKuB,EAAEvB,IAAMuB,EAAEzB,OAAS,IACxBG,KAAMsB,EAAEtB,IAAAA,EAEVwB,MAAS,CACd,CACH,CAAA,CACA,EACDT,GACC,CAACE,GACDQ,EAAAA,QAAAA,eACG3B,EAAI,CACH,IAAKiB,EAAIhB,IACT,KAAMgB,EAAIf,KACV,aAAc,IAAM,CAClB,GAAI,CAACQ,EAAIkB,QAAS,OACZC,MAAAA,EAAQnB,EAAIkB,QAAQb,eACpBe,EAAMpB,EAAIkB,QAAQZ,aACpBY,EAAAA,QAAQG,aACT,KAAInB,EAAKoB,MAAMH,EAAOC,CAAG,MAC1BD,EACAC,CAAG,CAEP,EACA,eAAgB,IAAM,CACpB,GAAI,CAACpB,EAAIkB,QAAS,OACZC,MAAAA,EAAQnB,EAAIkB,QAAQb,eACpBe,EAAMpB,EAAIkB,QAAQZ,aACpBY,EAAAA,QAAQG,aACT,IAAGnB,EAAKoB,MAAMH,EAAOC,CAAG,KACzBD,EACAC,CAAG,CAEP,EACA,eAAgB,IAAM,CACpB,GAAI,CAACpB,EAAIkB,QAAS,OACZC,MAAAA,EAAQnB,EAAIkB,QAAQb,eACpBe,EAAMpB,EAAIkB,QAAQZ,aACpBY,EAAAA,QAAQG,aACT,KAAInB,EAAKoB,MAAMH,EAAOC,CAAG,MAC1BD,EACAC,CAAG,CAEP,CAAA,CAAE,EAEJG,SAASC,IAAI,CACd,CAAA,CACC,CAEV,CACF"}